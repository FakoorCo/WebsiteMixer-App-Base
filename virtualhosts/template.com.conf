<VirtualHost *:80>
    ServerName [domain]
    ServerAlias www.[domain]
    Redirect permanent / https://[domain]/
</VirtualHost>

<VirtualHost *:443>
    ServerName [domain]
    ServerAlias www.[domain]
    DocumentRoot /var/www
    Header always set Strict-Transport-Security "max-age=63072000; includeSubdomains; preload"

    WSGIDaemonProcess api[appname] user=www-data group=www-data threads=5
    WSGIScriptAlias / /srv/[domain]/api.wsgi
    WSGIPassAuthorization On

    <Directory /var/www>
        Order deny,allow
        Allow from all
    </Directory>

    <Directory /srv/[domain]>
        WSGIProcessGroup api[appname]
        WSGIApplicationGroup %{GLOBAL}
        WSGIScriptReloading On
        Order deny,allow
        Allow from all

        ExpiresActive On
        #ExpiresByType text/css   "now plus 7 days"
        ExpiresDefault "access plus 1 month"

        <FilesMatch "\.(ico|pdf|flv|jpg|jpeg|png|gif|js|css|swf)$">
        Header set Cache-Control "max-age=1296000, public"
        </FilesMatch>
	Require all granted
    </Directory>

    LogLevel warn
    CustomLog ${APACHE_LOG_DIR}/[domain]-ssl-access.log combined
    ErrorLog ${APACHE_LOG_DIR}/[domain]-ssl-error.log

    SSLEngine on
    SSLProtocol all -SSLv2 -SSLv3
    SSLHonorCipherOrder on
    SSLCipherSuite "EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384 EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH+aRSA+RC4 EECDH EDH+aRSA RC4 !aNULL !eNULL !LOW !3DES !MD5 !EXP !PSK !SRP !DSS !RC4"
    SSLCertificateFile      /etc/apache2/ssl/[domain]-w-chain.crt
    SSLCertificateKeyFile   /etc/apache2/ssl/[domain].key

</VirtualHost>

